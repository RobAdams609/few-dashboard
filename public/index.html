<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>FEW — Dashboard</title>
    <link rel="stylesheet" href="dashboard.css" />
    <style>
      :root{
        --bg:#10151c; --panel:#0b0f15; --line:#253041; --muted:#9fb0c8;
        --text:#cfd7e3; --glow:#fff5d6; --accent:#ffd36a; --good:#00e39b;
      }
      html,body{
        height:100%; margin:0; background:var(--bg); color:var(--text);
        font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;
      }

      /* Ticker */
      .ticker{
        position:sticky; top:0; z-index:20;
        background:var(--panel); border-bottom:1px solid var(--line);
        padding:6px 10px; font-size:12px; color:#f0c060;
      }

      /* Banner */
      .banner{ text-align:center; padding:24px 12px 6px; }
      .title{
        font-size:44px; font-weight:800; line-height:1.1; color:var(--glow);
        text-shadow:0 0 24px rgba(255,210,90,.45);
      }
      .subtitle{ margin-top:10px; font-size:14px; color:#a9b3c5; }

      .section-label{ text-align:center; margin:14px 0 8px; color:var(--accent); font-weight:700; }

      /* KPI cards */
      .summary{ display:grid; grid-template-columns:repeat(auto-fit,minmax(160px,1fr)); gap:10px; padding:8px 10px 0; }
      .card{ background:var(--panel); border:1px solid var(--line); border-radius:12px; padding:10px; text-align:center; }
      .card .k{ font-size:12px; color:var(--muted); }
      .card .v{ font-size:20px; font-weight:800; margin-top:4px; color:var(--glow); }

      /* Table */
      table{ width:100%; border-collapse:collapse; background:#0f141c; margin-top:8px; }
      thead th{
        background:var(--panel); color:var(--muted); font-size:13px; text-align:left;
        padding:10px; border-top:1px solid var(--line); border-bottom:1px solid var(--line);
      }
      tbody td{ padding:10px; border-bottom:1px solid #1b2534; }
      td.num{ text-align:right; font-variant-numeric:tabular-nums; }

      .agent{ display:flex; align-items:center; gap:10px; }
      .avatar,.avatar-fallback{
        width:28px; height:28px; border-radius:50%; background:#1f2a3a;
        display:inline-flex; align-items:center; justify-content:center;
        font-size:12px; font-weight:700; color:#89a2c6;
      }

      /* Sale toast */
      .sale-pop{
        position:fixed; left:50%; transform:translateX(-50%); bottom:-80px;
        padding:10px 16px; border-radius:999px; background:#0b5d2a; color:#e7ffe7; font-weight:700;
        box-shadow:0 10px 30px rgba(0,0,0,.35); transition:bottom .35s ease; z-index:30;
      }
      .sale-pop.show{ bottom:18px; }

      /* OE countdown — bigger & pulsating */
      #oeBar{
        position:fixed; left:0; right:0; bottom:0; z-index:25;
        background:linear-gradient(90deg, rgba(11,15,21,.95), rgba(11,15,21,.95));
        border-top:1px solid var(--line);
        padding:12px 18px;
        font-size:16px; color:var(--muted); text-align:center;
      }
      #oeTimer{
        color:var(--good); font-weight:800; font-size:22px; letter-spacing:.5px;
        text-shadow:0 0 8px rgba(0,227,155,.65);
        animation:oePulse 1.6s ease-in-out infinite;
      }
      @keyframes oePulse{
        0%   { text-shadow:0 0 6px rgba(0,227,155,.6), 0 0 0 rgba(0,227,155,0); }
        50%  { text-shadow:0 0 18px rgba(0,227,155,.9), 0 0 24px rgba(0,227,155,.25); }
        100% { text-shadow:0 0 6px rgba(0,227,155,.6), 0 0 0 rgba(0,227,155,0); }
      }

      /* Spacer so OE bar & music dock don't cover the table */
      .footer-spacer{ height:64px; } /* was 32px */

      /* Centered Apple Music dock */
      #musicDock{
        position:fixed;
        left:50%;
        bottom:64px;                 /* comfortably above OE bar */
        transform:translateX(-50%);
        z-index:24;
        border-radius:14px;
        overflow:hidden;
        box-shadow:0 10px 30px rgba(0,0,0,.35);
        backdrop-filter:saturate(120%) blur(4px);
      }
      #musicDock iframe{
        width:340px; max-width:90vw; height:152px; border:0; background:transparent;
      }
      @media (max-width: 700px){
        #musicDock{ bottom:84px; }
      }
    </style>
  </head>

  <body>
    <div id="ticker" class="ticker">RULE OF THE DAY — …</div>

    <header class="banner">
      <div class="title">THE FEW — EVERYONE WANTS TO EAT BUT FEW WILL HUNT</div>
      <div id="principle" class="subtitle">Bonus: You are who you hunt with. Everybody wants to eat, but FEW will hunt.</div>
    </header>

    <div id="viewLabel" class="section-label">Today — Roster</div>

    <div id="summary" class="summary">
      <div class="card"><div class="k">Today — Team Calls</div><div id="sumCalls" class="v">0</div></div>
      <div class="card"><div class="k">Today — Team Talk (min)</div><div id="sumTalk" class="v">0</div></div>
      <div class="card"><div class="k">This Week — Team Sales</div><div id="sumSales" class="v">$0</div></div>
      <div class="card"><div class="k">This Week — Team AV (12×)</div><div id="sumAV" class="v">$0</div></div>
      <div class="card"><div class="k">Unassigned Sales</div><div id="sumUnassigned" class="v">$0</div></div>
    </div>

    <table id="board">
      <thead id="thead"></thead>
      <tbody id="tbody"><tr><td style="padding:18px;color:#5c6c82;">Loading…</td></tr></tbody>
    </table>

    <div class="footer-spacer"></div>

    <div id="salePop" class="sale-pop" role="status" aria-live="polite"></div>

    <!-- Centered Apple Music embed -->
    <div id="musicDock" aria-label="Apple Music Player">
      <iframe
        allow="autoplay *; encrypted-media *;"
        sandbox="allow-forms allow-popups allow-same-origin allow-scripts allow-top-navigation-by-user-activation"
        src="https://embed.music.apple.com/us/playlist/the-few/pl.u-4JomXN9TZB29Am">
      </iframe>
    </div>

    <!-- OE countdown -->
    <div id="oeBar">OE Countdown: <span id="oeTimer">…</span></div>

    <!-- bump cache-buster so Leads/Sold/Conv% show on Roster -->
    <script src="dashboard.js?v=8" defer></script>
    <script defer>
      (function(){
        const target = new Date('2025-11-01T00:00:00-04:00');
        const el = document.getElementById('oeTimer');
        function pad(n){return String(n).padStart(2,'0')}
        function tick(){
          const now = new Date();
          let s = Math.max(0, Math.floor((target - now)/1000));
          const d = Math.floor(s/86400); s%=86400;
          const h = Math.floor(s/3600); s%=3600;
          const m = Math.floor(s/60); const sec = s%60;
          el.textContent = `${d}d ${pad(h)}h ${pad(m)}m ${pad(sec)}s`;
          requestAnimationFrame(()=>setTimeout(tick, 250));
        }
        tick();
      })();
    </script>
  </body>
</html>
